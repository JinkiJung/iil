{
    "$id": "https://github.com/JinkiJung/iil/blob/main/iil.schema.json",
    "$version": "1.0.9",
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "type": "object",
    "description": "iil: a work description model.",
    "properties": {
        "id": {
            "type": "string",
            "format": "uuid",
            "description": "An unique identifier for an iil."
        },
        "activateIf": {
            "$ref": "#/$defs/Condition",
            "description": "condition that activates this work."
        },
        "act": {
            "$ref": "#/$defs/Act",
            "description": "a single unit of behavior with a clear beginning and end."
        },
        "actor": {
            "type": "string",
            "description": "actor who is responsible for task performance."
        },
        "finishIf": {
            "$ref": "#/$defs/Condition",
            "description": "condition under which the task is completed."
        },
        "goal": {
            "type": "string",
            "format": "uuid",
            "description": "ID of the parent work item that this work contributes to."
        },
        "namespace": {
            "type": "string",
            "description": "a namespace under which the work is categorized."
        },
        "version": {
            "type": "string",
            "description": "a version number of the work."
        },
        "representation": {
            "type": "object",
            "additionalProperties": {
                "type": "object",
                "additionalProperties": true
            },
            "description": "flexible metadata that can be used to provide information and guide users towards completing a task"
        },
        "about": {
            "type": "object",
            "additionalProperties": {
                "type": "string"
            },
            "description": "metadata explaining the work itself"
        },
        "input": {
            "type": "object",
            "additionalProperties": {
                "type": "string"
            },
            "description": "input required for the work."
        },
        "output": {
            "type": "object",
            "additionalProperties": {
                "type": "string"
            },
            "description": "output produced by the task."
        },
        "variable": {
            "type": "object",
            "additionalProperties": {
                "type": "string"
            },
            "description": "variables associated with the task."
        },
        "maintainer": {
            "type": "string",
            "description": "ID of maintainer"
        },
        "owner": {
            "type": "string",
            "description": "ID of owner"
        },
        "state": {
            "type": "string",
            "enum": [
                "INACTIVATED",
                "ACTIVATED",
                "PENDING",
                "FINISHED",
                "ABORTED"
            ],
            "description": "a state of iil"
        },
        "abortIf": {
            "$ref": "#/$defs/Condition",
            "description": "condition of abortion (mostly due to external factor)"
        },
        "next": {
            "type": "object",
            "additionalProperties": {
                "type": "array",
                "item": "object",
                "additionalProperties": true
            },
            "description": "automated execution of the next work corresponding to the completion of the current work and evaluation of its output"
        },
        "executedNextCondition": {
            "type": "string",
            "description": "executed condition from next branch"
        },
        "onAbort": {
            "$ref": "#/$defs/Flow",
            "description": "flow control element"
        }
    },
    "required": [
        "finishIf",
        "act"
    ],
    "$defs": {
        "Act": {
            "type": "object",
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid"
                },
                "namespace": {
                    "type": "string"
                },
                "version": {
                    "type": "string"
                },
                "shortName": {
                    "type": "string"
                },
                "name": {
                    "type": "string"
                },
                "code": {
                    "type": "string"
                }
            }
        },
        "Condition": {
            "type": "object",
            "properties": {
                "id": {
                    "type": "string",
                    "format": "uuid"
                },
                "namespace": {
                    "type": "string"
                },
                "version": {
                    "type": "string"
                },
                "shortName": {
                    "type": "string"
                },
                "name": {
                    "type": "string"
                },
                "type": {
                    "type": "string",
                    "enum": [
                        "TIME",
                        "LOCATION",
                        "IIL_INPUT",
                        "IIL_VARIABLE",
                        "IIL_STATE",
                        "EVENT"
                    ]
                },
                "code": {
                    "type": "string"
                },
                "input": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "string"
                    },
                    "description": "external input"
                },
                "injectedBy": {
                    "type": "string",
                    "format": "uuid",
                    "description": "source iil ID for injection"
                }
            }
        },
        "Flow": {
            "type": "object",
            "properties": {
                "flowType": {
                    "type": "string",
                    "enum": [
                        "create",
                        "activate",
                        "finish"
                    ]
                },
                "fromIil": {
                    "type": "string",
                    "format": "uuid"
                },
                "toIil": {
                    "type": "string",
                    "format": "uuid"
                },
                "actor": {
                    "type": "string"
                },
                "inputInjection": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "array",
                        "item": "object",
                        "additionalProperties": true
                    }
                }
            },
            "required": [
                "flowType",
                "fromIil",
                "toIil"
            ]
        }
    }
}
